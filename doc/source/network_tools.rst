.. _network_tools:

Network Tools
=============



Netmake
-------

Netmake creates a compatible split system with circular ordering from a distance matrix.  Netmake's default mode uses the
well-known Neighbor-Net algorithm (Bryant and Moulton, 2004) for quickly (O(n^3)) constructing circular split systems.
NeighborNet is an extension of the Neighbor Joining algorithm that is used to create trees, with the difference that instead
of agglomerating two neighbors into a new node immediately, Neighbor-Net pairs up another set of candidate nodes before agglomerating
into a new node.  This process generates a collection of splits for which it might not be possible to represent in a single
tree, hence can be used to create split networks.  Running Neighbor-Net via netmake is straight forward. The only option
the user might wish to specify is the output_prefix. The input file can be either nexus format file containing a distances
block, or a phylip format distance matrix and netmake will produce a circular split network in nexus format.  So a typical
Neighbor-Net run producing an output file called "bees_out.network.nex" looks like this::

  netmake -o bees_out bees.nex


Netmake's alternate mode is based partially on work by Levy and Pachter (Levy and Pachter, 2008), where we construct a
circular split system by greedily optimising the minimum evolution criterion.  For more information on this mode
please see :download:`Thesis Chapter 4 <assets/spectre_bastkowskis_thesis.pdf>`.  Netmake in this mode requires that the
user specify the ``-alt`` switch.  Additional options maybe specified to select the runmode for the tool.  The full list
of options takes this form::

  netmake -alt [-o <output_prefix> -w <weighting_1> -x <weighting_2> -z <tree_weighting> <input_file>

A simple command line to run using the travelling sales man circular ordering configuration (the default option in alt mode) looks like this::

  netmake -alt -o bees_tsp_out bees.nex

And the command line run netmake in hybrid greedy minimum evolution would look like this::

  netmake -alt -o bees.t -w GREEDY_ME -x TREE bees.nex


Note that we also provide a graphical user interface for netmake which can be started using the ``netmake-gui`` tool.  The
same options are available in the GUI as the command line.


NetME
-----

NetME constructs a minimum evolution (ME) tree from the specified split network with an implied circular order.  Such split
systems can, for example, be generated by the NeighborNet algorithm or any for constructing phylogenetic networks
(see Netmake in the previous section).  More specifically, NetME is the implementation of an O(n 4 ) algorithm for
finding an optimal minimum evolution tree in a circular set of splits where the set of species is of size n.  For more
information on the algorithm please see and please cite (S. Bastkowski et al, 2014).

NetME takes in a nexus or phylip file containing a distance matrix and a nexus file containing a circular ordering (such
as that created by running Neighbor-Net via netmake) and outputs three files:

* The weighted split system, in nexus format, corresponding to a restricted minimum evolution tree, where the weights are derived from the Ordinary Least Squares (OLS) method used for constructing the tree.
* The weighted split system, in nexus format, corresponding to a restricted minimum evolution tree, where the weights are recalculated by using a Non-Negative Least Squares (NNLS) method.
* A file containing the tree length of tree weighted with OLS.

NetME can be run from the command line like this::

  netme [-o <output_prefix>] <distance_matrix_input_file> <circular_split_system_file>

Alternatively, NetME has a simple GUI which can be started by simply running ``netme-gui`` without any arguments.


References
----------

* D. Bryant and V. Moulton. Neighbor-net: an agglomerative method for the construction of phylogenetic networks. Mol. Biol. Evol., 21:255â€“265, 2004.
* D. Levy and L. Pachter. The Neighbor-Net Algorithm. ArXiv. 2008.
* S. Bastkowski. From Trees to Networks and Back.  :download:`PhD Thesis <assets/spectre_bastkowskis_thesis.pdf>`. 2013
* S. Bastkowski, A. Spillner, V. Moulton (2014) Fishing for Trees with NeighborNets. Information Processing Letters 114(1-2): 13-18.